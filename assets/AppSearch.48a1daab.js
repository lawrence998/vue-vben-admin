import{d as e,aK as t,aB as a,u as n,h as s,o,i as r,j as l,l as i,bx as c,r as u,d5 as d,dm as p,a0 as f,a1 as h,aU as m,e as v,bR as C,cB as x,bS as g,bv as b,b5 as _,N as y,dn as k,bJ as w,x as S,aD as $,K as E,bB as I,b2 as A,a3 as j,b8 as R,aL as N,aM as T,k as D,b4 as M,bO as O,b1 as U}from"./index.7f9d11df.js";/* empty css              */import{I as K}from"./index.5d173e58.js";import{C as B}from"./clickOutside.e14cef1b.js";import{b as L,u as W,d as z}from"./useHeaderSetting.766d89c2.js";import{u as F}from"./useScrollTo.59748d94.js";import{S as H}from"./SearchOutlined.eb5ee535.js";import"./vendor.3b1829c7.js";import"./EyeOutlined.00406e72.js";import"./domUtils.10b268bc.js";import"./_stringToArray.7199892a.js";var P=e({name:"AppSearchFooter",components:{Icon:t},setup(){const{prefixCls:e}=a("app-search-footer"),{t:t}=n();return{prefixCls:e,t:t}}});const J=c("data-v-5f9e3562")(((e,t,a,n,c,u)=>{const d=s("Icon");return o(),r("div",{class:`${e.prefixCls}`},[l("span",{class:`${e.prefixCls}__item`},[l(d,{icon:"ant-design:enter-outlined"})],2),l("span",null,i(e.t("component.app.toSearch")),1),l("span",{class:`${e.prefixCls}__item`},[l(d,{icon:"bi:arrow-up"})],2),l("span",{class:`${e.prefixCls}__item`},[l(d,{icon:"bi:arrow-down"})],2),l("span",null,i(e.t("component.app.toNavigate")),1),l("span",{class:`${e.prefixCls}__item`},[l(d,{icon:"mdi:keyboard-esc"})],2),l("span",null,i(e.t("common.closeText")),1)],2)}));P.render=J,P.__scopeId="data-v-5f9e3562";const q=["keydown"],G={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Q={esc:"Escape",tab:"Tab",enter:"Enter",space:" ",up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete"]},V={ctrl:e=>e.ctrlKey,shift:e=>e.shiftKey,alt:e=>e.altKey,meta:e=>e.metaKey};function X(e,t){if(!e.key)return!1;if(x(t))return e.keyCode===t;const a=t.split(".");let n=0;for(const s of a){const t=V[s],a=Q[s],o=G[s];(t&&t(e)||(a&&g(a)?a.includes(e.key):a===e.key)||(o&&g(o)?o.includes(e.keyCode):o===e.keyCode)||e.key.toUpperCase()===s.toUpperCase())&&n++}return n===a.length}function Y(e,t=p,a={}){const{events:n=q,target:s}=a;let o;function r(a){if(function(e){return m(e)?e:C(e)||x(e)?t=>X(t,e):g(e)?t=>e.some((e=>X(t,e))):e?()=>!0:()=>!1}(e)(a))return t(a)}f((()=>{if(o=function(e,t){if(!e)return t;return m(e)?e():v(e)}(s,window),o)for(const e of n)o.addEventListener(e,r)})),h((()=>{if(o)for(const e of n)o.removeEventListener(e,r)}))}var Z,ee;function te(e,t,a){const s=u([]),o=u(""),r=u(-1);let l=[];const{t:i}=n(),c=$(),[d]=b((function(e){null==e||e.stopPropagation();const t=e.target.value;if(o.value=t.trim(),!t)return void(s.value=[]);const a=function(e){const t=["",...[...e].map((e=>{return["$","(",")","*","+",".","[","]","?","\\","^","{","}","|"].includes(t=e)?`\\${t}`:t;var t})),""].join(".*");return new RegExp(t)}(v(o)),n=w(l,(e=>a.test(e.name)));s.value=p(n,a),r.value=0}),200);function p(e,t,a){const n=[];return e.forEach((e=>{const{name:s,path:o,icon:r,children:l}=e;t.test(s)&&!(null==l?void 0:l.length)&&n.push({name:(null==a?void 0:a.name)?`${a.name} > ${s}`:s,path:o,icon:r}),Array.isArray(l)&&l.length&&n.push(...p(l,t,e))})),n}function f(){const a=v(e);if(!a||!Array.isArray(a)||0===a.length||!v(t))return;const n=a[v(r)];if(!n)return;const s=v(t);if(!s)return;const o=n.offsetTop+n.offsetHeight,l=s.offsetHeight,{start:i}=F({el:s,duration:100,to:o-l});i()}async function h(){if(!s.value.length)return;const e=v(s),t=v(r);if(0===e.length||t<0)return;const a=e[t];m(),await S(),c(a.path)}function m(){s.value=[],a("close")}return _((async()=>{const e=await L();l=y(e),k(l,(e=>{e.name=i(e.name)}))})),Y(["enter","up","down","esc"],(e=>{switch(e.keyCode){case 38:s.value.length&&(r.value--,r.value<0&&(r.value=s.value.length-1),f());break;case 40:s.value.length&&(r.value++,r.value>s.value.length-1&&(r.value=0),f());break;case 13:h();break;case 27:m()}})),{handleSearch:d,searchResult:s,keyword:o,activeIndex:r,handleMouseenter:function(e){const t=e.target.dataset.index;r.value=Number(t)},handleEnter:h}}(ee=Z||(Z={}))[ee.UP=38]="UP",ee[ee.DOWN=40]="DOWN",ee[ee.ENTER=13]="ENTER",ee[ee.ESC=27]="ESC";var ae=e({name:"AppSearchModal",components:{Icon:t,SearchOutlined:H,AppSearchFooter:P,[K.name]:K},directives:{clickOutside:B},props:{visible:Boolean},emits:["close"],setup(e,{emit:t}){const s=u(null),{prefixCls:o}=a("app-search-modal"),{t:r}=n(),[l,i]=function(){const e=u([]);return d((()=>{e.value=[]})),[e,t=>a=>{e.value[t]=a}]}(),{getIsMobile:c}=W(),{handleSearch:p,searchResult:f,keyword:h,activeIndex:m,handleEnter:C,handleMouseenter:x}=te(l,s,t),g=E((()=>!h||0===v(f).length)),b=E((()=>[o,{[`${o}--mobile`]:v(c)}]));return{t:r,prefixCls:o,getClass:b,handleSearch:p,searchResult:f,activeIndex:m,getIsNotData:g,handleEnter:C,setRefs:i,scrollWrap:s,handleMouseenter:x,handleClose:function(){f.value=[],t("close")}}}});const ne=c("data-v-19f6df22"),se=ne(((e,t,a,n,c,u)=>{const d=s("SearchOutlined"),p=s("a-input"),f=s("Icon"),h=s("AppSearchFooter"),m=I("click-outside");return o(),r(O,{to:"body"},[l(M,{name:"zoom-fade",mode:"out-in"},{default:ne((()=>[e.visible?(o(),r("div",{key:0,class:e.getClass,onClick:t[4]||(t[4]=A((()=>{}),["stop"]))},[j(l("div",{class:`${e.prefixCls}-content`},[l("div",{class:`${e.prefixCls}-input__wrapper`},[l(p,{class:`${e.prefixCls}-input`,placeholder:e.t("common.searchText"),"allow-clear":"",onChange:e.handleSearch},{prefix:ne((()=>[l(d)])),_:1},8,["class","placeholder","onChange"]),l("span",{class:`${e.prefixCls}-cancel`,onClick:t[1]||(t[1]=(...t)=>e.handleClose&&e.handleClose(...t))},i(e.t("common.cancelText")),3)],2),j(l("div",{class:`${e.prefixCls}-not-data`},i(e.t("component.app.searchNotData")),3),[[R,e.getIsNotData]]),j(l("ul",{class:`${e.prefixCls}-list`,ref:"scrollWrap"},[(o(!0),r(N,null,T(e.searchResult,((a,n)=>(o(),r("li",{ref:e.setRefs(n),key:a.path,"data-index":n,onMouseenter:t[2]||(t[2]=(...t)=>e.handleMouseenter&&e.handleMouseenter(...t)),onClick:t[3]||(t[3]=(...t)=>e.handleEnter&&e.handleEnter(...t)),class:[`${e.prefixCls}-list__item`,{[`${e.prefixCls}-list__item--active`]:e.activeIndex===n}]},[l("div",{class:`${e.prefixCls}-list__item-icon`},[l(f,{icon:a.icon||"mdi:form-select",size:20},null,8,["icon"])],2),l("div",{class:`${e.prefixCls}-list__item-text`},i(a.name),3),l("div",{class:`${e.prefixCls}-list__item-enter`},[l(f,{icon:"ant-design:enter-outlined",size:20})],2)],42,["data-index"])))),128))],2),[[R,!e.getIsNotData]]),l(h)],2),[[m,e.handleClose]])],2)):D("",!0)])),_:1})])}));ae.render=se,ae.__scopeId="data-v-19f6df22";var oe=e({name:"AppSearch",components:{AppSearchModal:ae,Tooltip:U},setup(){const e=u(!1),{prefixCls:t}=a("app-search"),{getShowSearch:s}=z(),{t:o}=n();function r(){e.value=!0}function i(){e.value=!1}return()=>s.value?l("div",{class:t,onClick:r},[l(U,null,{title:()=>o("common.searchText"),default:()=>l(H,null,null)}),l(ae,{onClose:i,visible:v(e)},null)]):null}});oe.__scopeId="data-v-6cfe5d58";export default oe;
